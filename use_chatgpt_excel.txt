
1. 시트통합
' 시트통합
Sub ConsolidateSheets()
    Dim ws As Worksheet
    Dim masterSheet As Worksheet
    Dim lastRow As Long
    Dim nextRow As Long
    Dim wsName As String
    Dim i As Integer

    ' 기존의 '통합' 시트가 있는 경우 삭제
    On Error Resume Next
    Application.DisplayAlerts = False
    Sheets("통합").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0

    ' 새로운 '통합' 시트 추가
    Set masterSheet = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    masterSheet.Name = "통합"

    ' 첫 번째 시트의 헤더 복사
    Set ws = ThisWorkbook.Sheets(1)
    ws.Rows(1).Copy Destination:=masterSheet.Rows(1)

    ' 데이터 통합
    nextRow = 2 ' 데이터가 들어갈 다음 행 번호

    For i = 2018 To 2022
        wsName = CStr(i) & "년"
        Set ws = ThisWorkbook.Sheets(wsName)
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        If lastRow > 1 Then
            ws.Rows("2:" & lastRow).Copy Destination:=masterSheet.Rows(nextRow)
            nextRow = nextRow + lastRow - 1
        End If
    Next i

    MsgBox "데이터 통합이 완료되었습니다!"
End Sub


2. 파일통합
' 파일통합
Sub ConsolidateAccidentData()
    Dim ws As Worksheet
    Dim masterBook As Workbook
    Dim dataBook As Workbook
    Dim dataSheet As Worksheet
    Dim lastRow As Long
    Dim nextRow As Long
    Dim year As Integer
    Dim filePath As String
    Dim folderPath As String

    ' 폴더 경로 설정
    folderPath = "C:\업무\"  ' 적절한 폴더 경로로 변경하세요

    ' 새로운 통합 파일 생성
    Set masterBook = Workbooks.Add
    Set ws = masterBook.Sheets(1)
    ws.Name = "ConsolidatedData"

    ' 첫 번째 파일에서 헤더 복사
    filePath = folderPath & "2018년_광역시도_교통사고_사망자.xlsx"
    Set dataBook = Workbooks.Open(filePath)
    Set dataSheet = dataBook.Sheets(1)
    dataSheet.Rows(1).Copy Destination:=ws.Rows(1)
    dataBook.Close False

    ' 데이터 통합
    nextRow = 2 ' 데이터가 들어갈 다음 행 번호
    For year = 2018 To 2022
        filePath = folderPath & year & "년_광역시도_교통사고_사망자.xlsx"
        Set dataBook = Workbooks.Open(filePath)
        Set dataSheet = dataBook.Sheets(1)
        lastRow = dataSheet.Cells(dataSheet.Rows.Count, "A").End(xlUp).Row
        If lastRow > 1 Then
            dataSheet.Rows("2:" & lastRow).Copy Destination:=ws.Rows(nextRow)
            nextRow = nextRow + lastRow - 1
        End If
        dataBook.Close False
    Next year

    ' 통합 파일 저장
    masterBook.SaveAs folderPath & "Consolidated_교통사고_사망자.xlsx"
    masterBook.Close False

    MsgBox "데이터 통합이 완료되었습니다!"
End Sub

